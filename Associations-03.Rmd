---
title: "AACN Survey - 2022"
subtitle: "Associations"
date: "`r format(Sys.time(), '%B, %Y')`"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
```

```{r include=FALSE}
# Libraries ---------------------------------------------------------------

library(gtsummary)
library(haven)
library(labelled)
library(flextable)
library(glue)
library(tidyverse)

# Setup -------------------------------------------------------------------

source("00-variable_info.R", local = TRUE)
source("00-helper_functions.R", local = TRUE)

gtsummary::set_gtsummary_theme(theme_gtsummary)

flextable::set_flextable_defaults(
  table.layout = "autofit"
)

dta <- readRDS("data/raw_cleaned.rds")

labels <- labelled::var_label(dta)


missing_removed <- readxl::read_xlsx("AACN_survey-missing_values.xlsx", sheet = "MissingRemoved")

dta <- dta %>% filter(id %in% missing_removed$Responseid)

# in case Respect by variables are shown independenly
new_respect_labs <- labels[vars_respect_by] %>%  map(~ paste0("Respect by:", .))

new_comm_labs <- labels[vars_communication] %>%  map(~ paste0(., " rated Good or Excellent"))

```


<br>


## C4 WITH DEMOGRAPHICS D3B b. What is the highest degree you have received? 

<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = education,
    include = moral_distress,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$education ) %>% 
  modify_caption(paste0(
    "Association between '", labels$education, "' and '", labels$moral_distress, "'"))

```


<br>

\newpage
## C4 WITH DEMOGRAPHICS D6 Current position

<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = position,
    include = moral_distress,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$position ) %>% 
  modify_caption(paste0(
    "Association between '", labels$position, "' and '", labels$moral_distress, "'"))

```



<br>


## C4 WITH D4 Years of total nursing experience

<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = moral_distress,
    include = experience,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$moral_distress ) %>% 
  modify_caption(paste0(
    "Association between '", labels$experience, "' and '", labels$moral_distress, "'"))

```

<br>

\newpage
## C18 Do you plan to leave your present nursing position? WITH C18A How likely would each of the following influence you to reconsider your plans to leave your present position?


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = plan_leave,
    include = all_of(vars_influence),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = "How likely would each of the following influence you to reconsider your plans to leave your present position?") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$plan_leave ) %>% 
  modify_caption(paste0(
    "Association between '", labels$plan_leave, "' and 'How likely would each of the following influence you to reconsider your plans to leave your present position?'"))


```

<br>

\newpage
##C17 On the whole, how satisfied are you with your current job? WITH C14 To what degree do you agree with the statement “My organization values my health and safety”?


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = satisfied_overall,
    include = value_health_safety,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$satisfied_overall ) %>% 
  modify_caption(paste0(
    "Association between '", labels$satisfied_overall, ", and '", labels$value_health_safety, "'"))


```


<br>

\newpage
##  C11 In the past year, in your work as a nurse, please indicate the number of times you personally experienced each of the following? WITH C8 Does your organization have a zero tolerance policy on verbal abuse?;   


The below tables, show the proportion of patients having at least one incident of abuse.
The proportions are within the level of the question `Does your organization have a zero tolerance policy on verbal abuse?`.    


<br>

- Physical Abuse

```{r eval=FALSE, include=FALSE}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(incident_any = factor(incident_any, labels = c("No", "Yes"))) %>% 
  mutate(across(all_of(vars_incident_all), ~if_else(. > 0, 1, 0))) %>% 
  mutate(across(all_of(vars_incident_all), ~factor(., labels = c("No", "Yes"))) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  mutate(across(where(is.labelled), as_factor)) %>% 
  tbl_summary(
    by = tolerance_verbal,
    include = all_of(vars_incident_abuse_physical),
  ) %>% 
  add_overall() %>% 
  modify_header(label = "At least one incident of:") %>%  
  add_p() %>% 
  modify_caption( paste0("Association of 'Physical Abuse' and '", labels$tolerance_verbal, "'") )%>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_verbal ) 

```


- Verbal Abuse

<br>

```{r eval=FALSE, include=FALSE}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(incident_any = factor(incident_any, labels = c("No", "Yes"))) %>% 
  mutate(across(all_of(vars_incident_all), ~if_else(. > 0, 1, 0))) %>% 
  mutate(across(all_of(vars_incident_all), ~factor(., labels = c("No", "Yes"))) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  mutate(across(where(is.labelled), as_factor)) %>% 
  tbl_summary(
    by = tolerance_verbal,
    include = all_of(vars_incident_abuse_verbal),
  ) %>% 
  add_overall() %>% 
  modify_header(label = "At least one incident of:") %>%  
  add_p() %>% 
  modify_caption( paste0("Association of 'Verbal Abuse' and '", labels$tolerance_verbal, "'") )%>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_verbal ) 

```


<br>


- Discrimination 

<br>

```{r eval=FALSE, include=FALSE}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(incident_any = factor(incident_any, labels = c("No", "Yes"))) %>% 
  mutate(across(all_of(vars_incident_all), ~if_else(. > 0, 1, 0))) %>% 
  mutate(across(all_of(vars_incident_all), ~factor(., labels = c("No", "Yes"))) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  mutate(across(where(is.labelled), as_factor)) %>% 
  tbl_summary(
    by = tolerance_verbal,
    include = all_of(vars_incident_discrim),
  ) %>% 
  add_overall() %>% 
  modify_header(label = "At least one incident of:") %>% 
  add_p() %>% 
  modify_caption( paste0("Association of 'Discrimination' and '", labels$tolerance_verbal, "'") )%>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_verbal ) 

```


<br>


- Sexual Harassment 

<br>

```{r eval=FALSE, include=FALSE}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(incident_any = factor(incident_any, labels = c("No", "Yes"))) %>% 
  mutate(across(all_of(vars_incident_all), ~if_else(. > 0, 1, 0))) %>% 
  mutate(across(all_of(vars_incident_all), ~factor(., labels = c("No", "Yes"))) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  mutate(across(where(is.labelled), as_factor)) %>% 
  tbl_summary(
    by = tolerance_verbal,
    include = all_of(vars_incident_harass),
  ) %>% 
  add_overall() %>% 
  modify_header(label = "At least one incident of:") %>% 
  add_p() %>% 
  modify_caption( paste0("Association of 'Sexual Harassment ' and '", labels$tolerance_verbal, "'") )%>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_verbal ) 

```


\newpage
## C14 To what degree do you agree with the statement “My organization values my health and safety”?  WITH C8 Does your organization have a zero tolerance policy on verbal abuse?;   

<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_verbal,
    include = value_health_safety,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_verbal ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_verbal, ", and '", labels$value_health_safety, "'"))


```


\newpage
## C9 Does your organization have a zero tolerance policy on physical abuse?   WITH C1 –C7 


<br>

- Quality of communication

```{r}

group_items <- "How would you rate the quality of communication in your unit among the following?"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = all_of(vars_communication),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", group_items, "'"))
```



<br>

- Quality of collaboration

```{r}

group_items <- "How would you rate the quality of collaboration in your unit among the following?"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = all_of(vars_collaboration),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", group_items, "'"))
```



<br>

- Respect for nurses

```{r}

group_items <- "In your unit how would you rate the respect for nurses by each of the following?"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = all_of(vars_respect_by),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", group_items, "'"))

```


<br>


- Moral Distress 

```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = moral_distress,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", labels$moral_distress, "'"))

```


<br>


- Staffing for your unit 

```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = staffing_right,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", labels$staffing_right, "'"))

```



<br>

- Skill of your unit Nursing managers

```{r}

group_items <- "Please rate the skill of your unit Nursing managers in the following areas"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = all_of(vars_skills_manager),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", group_items, "'"))

```



<br>

- Skill of your hospital nursing administrators

```{r}

group_items <- "Please rate the skill of your hospital nursing administrators in the following"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = tolerance_physical,
    include = all_of(vars_skills_manager),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$tolerance_physical ) %>% 
  modify_caption(paste0(
    "Association between '", labels$tolerance_physical, ", and '", group_items, "'"))

```



\newpage
## C16 To what extent are you evaluated on how well you contribute to a healthy work environment for you and your colleagues? WITH C1 –C7



<br>

- Quality of communication

```{r}

group_items <- "How would you rate the quality of communication in your unit among the following?"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = all_of(vars_communication),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", group_items, "'"))
```



<br>

- Quality of collaboration

```{r}

group_items <- "How would you rate the quality of collaboration in your unit among the following?"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = all_of(vars_collaboration),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", group_items, "'"))
```



<br>

- Respect for nurses

```{r}

group_items <- "In your unit how would you rate the respect for nurses by each of the following?"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = all_of(vars_respect_by),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", group_items, "'"))

```


<br>


- Moral Distress 

```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = moral_distress,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", labels$moral_distress, "'"))

```


<br>


- Staffing for your unit 

```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = staffing_right,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", labels$staffing_right, "'"))

```



<br>

- Skill of your unit Nursing managers

```{r}

group_items <- "Please rate the skill of your unit Nursing managers in the following areas"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = all_of(vars_skills_manager),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", group_items, "'"))

```



<br>

- Skill of your hospital nursing administrators

```{r}

group_items <- "Please rate the skill of your hospital nursing administrators in the following"

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  tbl_summary(
    by = evaluate_contrib_hwe,
    include = all_of(vars_skills_manager),
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$evaluate_contrib_hwe ) %>% 
  modify_caption(paste0(
    "Association between '", labels$evaluate_contrib_hwe, ", and '", group_items, "'"))

```


\newpage
## C17 On the whole, how satisfied are you with your current job? WITH C10 What are the main factors that keep you working in your current organization? Check two items from the list below…


<br>


The table shows the proportion of nurses who selected each factor, across the levels of the job satisfaction and Overall.

Eg. Overall, 419 nurses (41%) selected 'People I work with" as a factor that keeps them working in their current organisation. However this proportion varies according to wjat they have responded in the question 'On the whole, how satisfied are you with your current job?., where of those who responded "Very Satisfied' 52% selected 'People I work with' as a factor to keep them in their work, and this proportion drops as the level of satisfaction drops (p<0.0001). THose that are very dissatosfied with their current job, only 25% selected People I work with as facrtor to keep them in their current work.

<br>

```{r}
group_items = "What are the main factors that keep you working in your current organization? "

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(all_of(vars_factors_keep_work), ~if_else(. > 0, 1, 0))) %>% 
  mutate(across(all_of(vars_factors_keep_work), ~factor(., labels = c("No", "Yes"))) ) %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  tbl_summary(
    by = plan_leave,
    include = all_of(vars_factors_keep_work),
    missing = "no"
  ) %>% 
    add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$plan_leave ) %>% 
  modify_caption(paste0(
    "Association between '", labels$plan_leave, ", and '", group_items, "'"))


```


<br>

\newpage
## C18 Do you plan to leave your present nursing position? WITH C10 What are the main factors that keep you working in your current organization? Check two items from the list below…


The table shows the proportion of nurses who selected each factor, across the levels of their palns to leave their present nursding position.

Eg. Overall, 419 nurses (41%) selected 'People I work with" as a factor that keeps them working in their current organisation. However this proportion varies according to what they have responded in the question 'Do you plan to leave your present nursing position?', where of those who responded "No plans to leave within the next 3 years' 43% selected 'People I work with' as a factor to keep them in their work, and this proportion drops for those who 'within the next 12 months' and 'within the next 3 years' who only 36% and 35% selected People I work with(p<0.0001).

<br>

```{r}
group_items = "What are the main factors that keep you working in your current organization? "

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(all_of(vars_factors_keep_work), ~if_else(. > 0, 1, 0))) %>% 
  mutate(across(all_of(vars_factors_keep_work), ~factor(., labels = c("No", "Yes"))) ) %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  tbl_summary(
    by = satisfied_overall,
    include = all_of(vars_factors_keep_work),
    missing = "no"
  ) %>% 
    add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = group_items) %>% 
  modify_spanning_header( all_stat_cols() ~ labels$satisfied_overall ) %>% 
  modify_caption(paste0(
    "Association between '", labels$satisfied_overall, ", and '", group_items, "'"))


```

<br>

\newpage

## C14 To what degree do you agree with the statement “My organization values my health and safety”?   WITH C12. If you answered one or more times to any of the questions above, did you report the incident(s) to your supervisor? 


<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  tbl_summary(
    by = reported_incident,
    include = value_health_safety,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$reported_incident ) %>% 
  modify_caption(paste0(
    "Association between '", labels$reported_incident, ", and '", labels$value_health_safety, "'"))

```

<br>

\newpage
## C14 To what degree do you agree with the statement “My organization values my health and safety”?   WITH C12a. What happened when you reported the incident(s)?


<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  filter(reported_incident %in% c(1,2)) %>% 
  #filter(report_after == 7)
  mutate(across(where(is.labelled), as_factor) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  tbl_summary(
    by = report_after,
    include = value_health_safety,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$report_after ) %>% 
  modify_caption(paste0(
    "Association between '", labels$report_after, ", and '", labels$value_health_safety, "'"))

```

<br>

The 'Other (Pleae Specify)' is as follows:

```{r}

readxl::read_xlsx("data/report_after_other.xlsx") %>% 
  select(-id) %>% 
  flextable() %>% 
  flextable::set_caption(
    "What happened when you reported the incident(s)?: Other (Pleae Specify)"
  )

```


\newpage

## C14 To what degree do you agree with the statement “My organization values my health and safety”?  C12b. In case you did not report the incident (s), why did you decide not to report it?


<br>


```{r}

dta %>% 
  filter(section == "Section C") %>% 
  filter(reported_incident == 0) %>% 
  filter(no_report_why != 8) %>% 
  mutate(across(where(is.labelled), as_factor) ) %>% 
  set_variable_labels(.labels = labels) %>% 
  mutate(no_report_why = fct_drop(no_report_why)) %>% 
  tbl_summary(
    by = no_report_why,
    include = value_health_safety,
    missing = "no"
  ) %>% 
  add_overall() %>% 
  add_p( test = list(all_categorical() ~ "chisq.test") ) %>% 
  modify_header(label = " ") %>% 
  modify_spanning_header( all_stat_cols() ~ labels$no_report_why ) %>% 
  modify_caption(paste0(
    "Association between '", labels$no_report_why, ", and '", labels$value_health_safety, "'"))

```

<br>


The 'Other (Pleae Specify)' is as follows:

```{r}

readxl::read_xlsx("data/no_report_why.xlsx") %>% 
  select(-id) %>% 
  flextable() %>% 
  flextable::set_caption(
    "In case you did not report the incident (s), why did you decide not to report it? - Other(please specify)"
  )

```


